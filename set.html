<!DOCTYPE html>
<html>
<head>
<script src="map-set-for-each.js"></script>
<style>

body {
  font-family: monospace;
  white-space: pre;
}

</style>
</head>
<body>
<script>

function print(s) {
  document.body.appendChild(document.createTextNode(s + '\n'));
}

function assertEquals(a, b) {
  if (a === b)
    print('PASS: ' + a);
  else
    print('FAIL: ' + a + ' !== ' + b);
}

var s = new Set;
s.add('a');
assertEquals(true, s.has('a'));
assertEquals(false, s.has(new String('a')));

s.add('b');
s.delete('a');
assertEquals(false, s.has('a'));
s.add('a');

function keys(set) {
  var rv = [];
  set.forEach(function(_, k) {
    rv.push(k);
  });
  return rv;
}

function values(set) {
  var rv = [];
  set.forEach(function(v) {
    rv.push(v);
  });
  return rv;
}

s.forEach(function(v, k) {
  assertEquals(v, k);
  assertEquals(true, s.has(k));
  assertEquals(s, this);
  if (k === 'b') {
    s.delete('b');
    s.add('c');
  }
});

assertEquals('ac', keys(s).join(''));
assertEquals('ac', values(s).join(''));

for (var i = 0; i < 500; i++) {
  s.add(i);
}

for (var i = 0; i < 500; i++) {
  if (i % 100)
    s.delete(i);
}

assertEquals('ac0100200300400', keys(s).join(''));
assertEquals('ac0100200300400', values(s).join(''));

var obj = {};
s.forEach(function(v, k, self) {
  assertEquals(s, self);
  assertEquals(this, obj);
}, obj);

</script>
</body>
</html>